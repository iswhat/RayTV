// Config.ets - 配置信息数据模型
// 定义应用全局配置的数据结构

/**
 * 播放器配置接口
 */
export interface PlayerConfig {
  defaultPlayer: 'system' | 'custom'; // 默认播放器
  enableHardwareDecode: boolean;     // 启用硬件解码
  autoContinuePlay: boolean;         // 自动续播
  rememberPosition: boolean;         // 记住播放位置
  speedList: number[];               // 播放速度列表
  defaultSpeed: number;              // 默认播放速度
  enableHDR: boolean;                // 启用HDR
  enableDolby: boolean;              // 启用杜比音效
  autoPlayNext: boolean;             // 自动播放下一集
  defaultResolution?: string;        // 默认分辨率
  aspectRatio: 'auto' | '16:9' | '4:3' | 'custom'; // 画面比例
  subtitlesEnabled: boolean;         // 启用字幕
  defaultSubtitleLanguage?: string;  // 默认字幕语言
  defaultAudioTrack?: string;        // 默认音轨
  backgroundPlay: boolean;           // 后台播放
  playMode: 'single' | 'loop' | 'shuffle'; // 播放模式
  networkBufferSize?: number;        // 网络缓冲大小（MB）
  localBufferSize?: number;          // 本地缓冲大小（MB）
  seekStepForward: number;           // 快进步长（秒）
  seekStepBackward: number;          // 快退步长（秒）
}

/**
 * 显示配置接口
 */
export interface DisplayConfig {
  theme: 'light' | 'dark' | 'system'; // 主题
  fontSize: number;                  // 字体大小
  autoFullScreen: boolean;           // 自动全屏
  enableGestures: boolean;           // 启用手势
  animationEnabled: boolean;         // 启用动画
  transitionSpeed: 'slow' | 'normal' | 'fast'; // 过渡速度
  showFPS: boolean;                  // 显示FPS
  showNetworkSpeed: boolean;         // 显示网速
  showTimeCode: boolean;             // 显示时间码
  maxColumns: number;                // 最大列数
  posterAspectRatio: 'auto' | '2:3' | '3:4' | '16:9'; // 海报比例
  hideNavOnPlay: boolean;            // 播放时隐藏导航栏
  screenSaverDelay?: number;         // 屏幕保护延迟（分钟）
  colorPrimary?: string;             // 主题色
  colorAccent?: string;              // 强调色
  customStyles?: Map<string, any>;   // 自定义样式
  tvMode: boolean;                   // TV模式
  tabletMode: boolean;               // 平板模式
  phoneMode: boolean;                // 手机模式
}

/**
 * 网络配置接口
 */
export interface NetworkConfig {
  timeout: number;                   // 超时时间（秒）
  retryCount: number;                // 重试次数
  enableCache: boolean;              // 启用缓存
  cacheSize: number;                 // 缓存大小（MB）
  maxConcurrentRequests: number;     // 最大并发请求数
  connectionTimeout: number;         // 连接超时（秒）
  readTimeout: number;               // 读取超时（秒）
  writeTimeout: number;              // 写入超时（秒）
  enableProxy: boolean;              // 启用代理
  proxyServer?: string;              // 代理服务器
  proxyPort?: number;                // 代理端口
  userAgent?: string;                // 自定义User-Agent
  enableDNSCache: boolean;           // 启用DNS缓存
  dnsCacheTime?: number;             // DNS缓存时间（分钟）
  enableHttp2: boolean;              // 启用HTTP/2
  enableCompression: boolean;        // 启用压缩
  allowInsecureConnections: boolean; // 允许不安全连接
  certificate?: string;              // 自定义证书
}

/**
 * 安全配置接口
 */
export interface SecurityConfig {
  enableSandbox: boolean;            // 启用沙箱
  allowThirdParty: boolean;          // 允许第三方JAR加载
  dataEncryption: boolean;           // 数据加密
  requireBiometricAuth: boolean;     // 生物识别认证
  appLockEnabled: boolean;           // 应用锁
  appLockTimeout?: number;           // 应用锁超时（分钟）
  autoClearCacheOnExit: boolean;     // 退出时自动清除缓存
  privateMode: boolean;              // 隐私模式
  hideSensitiveInfo: boolean;        // 隐藏敏感信息
  enableAntiCheat: boolean;          // 启用反作弊
  safeBrowsingEnabled: boolean;      // 安全浏览
  contentRestrictions?: {
    enabled: boolean;
    rating?: string;
    password?: string;
  };
}

/**
 * 广告屏蔽配置接口
 */
export interface AdBlockConfig {
  enabled: boolean;                  // 启用广告屏蔽
  rules: string[];                   // 屏蔽规则
  updateInterval: number;            // 更新间隔（小时）
  blockVideoAds: boolean;            // 屏蔽视频广告
  blockPopupAds: boolean;            // 屏蔽弹窗广告
  customFilters?: string[];          // 自定义过滤规则
  filterLists?: string[];            // 过滤规则列表URL
  whitelist?: string[];              // 白名单
  lastUpdateTime?: number;           // 最后更新时间
}

/**
 * 鸿蒙特有配置接口
 */
export interface HarmonyConfig {
  enableVoiceAssistant: boolean;     // 启用语音助手
  enableDeviceFlow: boolean;         // 启用设备流转
  enableGestureControl: boolean;     // 启用手势控制
  enableWidget: boolean;             // 启用桌面小组件
  enableNotification: boolean;       // 启用通知
  enableAutoStart: boolean;          // 启用自启动
  enableBackgroundSync: boolean;     // 启用后台同步
  enableMultiWindow: boolean;        // 启用多窗口
  enableHiAI: boolean;               // 启用HiAI加速
  enableSuperDevice: boolean;        // 启用超级终端
  deviceSharingEnabled: boolean;     // 设备共享
  notificationChannels?: string[];   // 通知渠道
  quickActions?: string[];           // 快捷操作
}

/**
 * 搜索配置接口
 */
export interface SearchConfig {
  enableAutoSuggest: boolean;        // 启用自动建议
  searchHistoryLimit: number;        // 搜索历史限制
  enableGlobalSearch: boolean;       // 启用全局搜索
  searchTimeout: number;             // 搜索超时（秒）
  searchDelay: number;               // 搜索延迟（毫秒）
  defaultSearchFilter?: string;      // 默认搜索筛选
  searchHighlight: boolean;          // 搜索结果高亮
  enableSearchAnalytics: boolean;    // 启用搜索分析
}

/**
 * 下载配置接口
 */
export interface DownloadConfig {
  enableDownload: boolean;           // 启用下载
  maxConcurrentDownloads: number;    // 最大并发下载数
  downloadPath?: string;             // 下载路径
  autoDownloadNextEpisode: boolean;  // 自动下载下一集
  downloadOnWifiOnly: boolean;       // 仅WiFi下载
  downloadQuality?: string;          // 下载质量
  enableDownloadQueue: boolean;      // 启用下载队列
  downloadTimeout: number;           // 下载超时（秒）
  enableBackgroundDownload: boolean; // 启用后台下载
}

/**
 * 同步配置接口
 */
export interface SyncConfig {
  enableCloudSync: boolean;          // 启用云同步
  syncInterval: number;              // 同步间隔（分钟）
  syncOnWifiOnly: boolean;           // 仅WiFi同步
  syncHistory: boolean;              // 同步历史记录
  syncFavorites: boolean;            // 同步收藏
  syncSettings: boolean;             // 同步设置
  autoBackup: boolean;               // 自动备份
  backupInterval?: number;           // 备份间隔（天）
  cloudAccount?: {
    type: string;
    username?: string;
    token?: string;
    lastSyncTime?: number;
  };
}

/**
 * 日志配置接口
 */
export interface LogConfig {
  enableLogging: boolean;            // 启用日志
  logLevel: 'debug' | 'info' | 'warn' | 'error'; // 日志级别
  logToFile: boolean;                // 记录到文件
  maxLogSize?: number;               // 最大日志大小（MB）
  logRetentionDays?: number;         // 日志保留天数
  enableAnalytics: boolean;          // 启用分析
  crashReporting: boolean;           // 崩溃报告
}

/**
 * 应用配置主接口
 */
export interface AppConfig {
  player: PlayerConfig;              // 播放器配置
  display: DisplayConfig;            // 显示配置
  network: NetworkConfig;            // 网络配置
  security: SecurityConfig;          // 安全配置
  adBlock: AdBlockConfig;            // 广告屏蔽配置
  harmony: HarmonyConfig;            // 鸿蒙特有配置
  search: SearchConfig;              // 搜索配置
  download: DownloadConfig;          // 下载配置
  sync: SyncConfig;                  // 同步配置
  log: LogConfig;                    // 日志配置
  version: string;                   // 配置版本
  lastUpdated: number;               // 最后更新时间
  migrationVersion?: string;         // 迁移版本
  customSettings?: Map<string, any>; // 自定义设置
}

/**
 * 配置版本信息接口
 */
export interface ConfigVersion {
  version: string;                   // 版本号
  buildTime: number;                 // 构建时间
  minAppVersion: string;             // 最低应用版本
  changelog?: string;                // 更新日志
}

/**
 * 配置变更记录接口
 */
export interface ConfigChange {
  keyPath: string;                   // 配置路径
  oldValue: any;                     // 旧值
  newValue: any;                     // 新值
  changedAt: number;                 // 变更时间
  changedBy: 'user' | 'system' | 'sync'; // 变更来源
}

/**
 * 配置预设接口
 */
export interface ConfigPreset {
  id: string;                        // 预设ID
  name: string;                      // 预设名称
  description?: string;              // 描述
  config: Partial<AppConfig>;        // 预设配置
  isDefault?: boolean;               // 是否默认预设
  deviceType?: string;               // 适用设备类型
  tags?: string[];                   // 标签
}

/**
 * 配置导入导出选项接口
 */
export interface ConfigImportExportOptions {
  includeCredentials?: boolean;      // 包含凭证
  includeHistory?: boolean;          // 包含历史记录
  includeFavorites?: boolean;        // 包含收藏
  format: 'json' | 'encrypted';      // 格式
  password?: string;                 // 密码
  description?: string;              // 描述
}

/**
 * 配置验证结果接口
 */
export interface ConfigValidationResult {
  valid: boolean;                    // 是否有效
  errors?: {
    field: string;
    message: string;
  }[];
  warnings?: {
    field: string;
    message: string;
  }[];
  suggestions?: {
    field: string;
    value: any;
    reason: string;
  }[];
}