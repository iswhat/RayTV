// DatabaseModel - æ•°æ®åº“ç›¸å…³æ¨¡å‹å®šä¹?// å®šä¹‰æ•°æ®åº“è¡¨ç»“æ„ã€æŸ¥è¯¢æ¡ä»¶ç­‰æ•°æ®æ¨¡å‹

/**
 * æ•°æ®åº“é…ç½®æ¥å? */
export interface DatabaseConfig {
  /**
   * æ•°æ®åº“åç§?   */
  name: string;
  
  /**
   * æ•°æ®åº“ç‰ˆæœ?   */
  version: number;
  
  /**
   * æ•°æ®åº“æè¿?   */
  description?: string;
  
  /**
   * æ•°æ®åº“å¤§å°é™åˆ¶ï¼ˆå­—èŠ‚ï¼?   */
  size?: number;
}

/**
 * æ•°æ®åº“åˆ—å®šä¹‰æ¥å£
 */
/**
 * æ•°æ®åº“æ”¯æŒçš„å€¼ç±»å? */
export type DatabaseValueType = string | number | boolean | null;

export interface DatabaseColumn {
  /**
   * åˆ—å
   */
  name: string;
  
  /**
   * æ•°æ®ç±»å‹
   */
  type: string;
  
  /**
   * æ˜¯å¦ä¸ºä¸»é”?   */
  primaryKey?: boolean;
  
  /**
   * æ˜¯å¦è‡ªå¢
   */
  autoIncrement?: boolean;
  
  /**
   * æ˜¯å¦å”¯ä¸€
   */
  unique?: boolean;
  
  /**
   * æ˜¯å¦éç©º
   */
  notNull?: boolean;
  
  /**
   * é»˜è®¤å€?   */
  defaultValue?: DatabaseValueType;
  
  /**
   * æ³¨é‡Š
   */
  comment?: string;
}

/**
 * æ•°æ®åº“è¡¨å®šä¹‰æ¥å£
 */
export interface DatabaseTable {
  /**
   * è¡¨å
   */
  name: string;
  
  /**
   * åˆ—å®šä¹?   */
  columns: DatabaseColumn[];
  
  /**
   * ç´¢å¼•å®šä¹‰
   */
  indexes?: DatabaseIndex[];
  
  /**
   * å¤–é”®å®šä¹‰
   */
  foreignKeys?: DatabaseForeignKey[];
  
  /**
   * è¡¨æ³¨é‡?   */
  comment?: string;
}

/**
 * æ•°æ®åº“ç´¢å¼•å®šä¹‰æ¥å? */
export interface DatabaseIndex {
  /**
   * ç´¢å¼•åç§°
   */
  name: string;
  /**
   * ç´¢å¼•å­—æ®µ
   */
  columns: string[];
  /**
   * æ˜¯å¦å”¯ä¸€ç´¢å¼•
   */
  unique?: boolean;
}

/**
 * æ•°æ®åº“å¤–é”®å®šä¹‰æ¥å? */
export interface DatabaseForeignKey {
  /**
   * å¤–é”®åç§°
   */
  name: string;
  /**
   * æºè¡¨å­—æ®µ
   */
  sourceColumns: string[];
  /**
   * ç›®æ ‡è¡¨å
   */
  targetTable: string;
  /**
   * ç›®æ ‡è¡¨å­—æ®?   */
  targetColumns: string[];
  /**
   * åˆ é™¤æ—¶è¡Œä¸?   */
  onDelete?: ForeignKeyAction;
  /**
   * æ›´æ–°æ—¶è¡Œä¸?   */
  onUpdate?: ForeignKeyAction;
}

/**
 * å¤–é”®åŠ¨ä½œæšä¸¾
 */
export enum ForeignKeyAction {
  /**
   * çº§è”åˆ é™¤/æ›´æ–°
   */
  CASCADE = 'CASCADE',
  /**
   * è®¾ç½®ä¸ºç©º
   */
  SET_NULL = 'SET NULL',
  /**
   * è®¾ç½®é»˜è®¤å€?   */
  SET_DEFAULT = 'SET DEFAULT',
  /**
   * é™åˆ¶æ“ä½œ
   */
  RESTRICT = 'RESTRICT',
  /**
   * æ— æ“ä½?   */
  NO_ACTION = 'NO ACTION'
}

/**
 * æŸ¥è¯¢æ“ä½œç¬¦æšä¸? */
export enum QueryOperator {
  /**
   * ç­‰äº
   */
  EQUAL = '=',
  /**
   * ä¸ç­‰äº?   */
  NOT_EQUAL = '!=',
  /**
   * å¤§äº
   */
  GREATER_THAN = '>',
  /**
   * å¤§äºç­‰äº
   */
  GREATER_THAN_OR_EQUAL = '>=',
  /**
   * å°äº
   */
  LESS_THAN = '<',
  /**
   * å°äºç­‰äº
   */
  LESS_THAN_OR_EQUAL = '<=',
  /**
   * åŒ…å«
   */
  LIKE = 'LIKE',
  /**
   * ä¸åŒ…å?   */
  NOT_LIKE = 'NOT LIKE',
  /**
   * ä¸ºç©º
   */
  IS_NULL = 'IS NULL',
  /**
   * ä¸ä¸ºç©?   */
  IS_NOT_NULL = 'IS NOT NULL',
  /**
   * åœ¨èŒƒå›´å†…
   */
  IN = 'IN',
  /**
   * ä¸åœ¨èŒƒå›´å†?   */
  NOT_IN = 'NOT IN',
  /**
   * ä»‹äº
   */
  BETWEEN = 'BETWEEN'
}

/**
 * æŸ¥è¯¢æ¡ä»¶æ¥å£
 */
export interface QueryCondition {
  /**
   * å­—æ®µå?   */
  field: string;
  /**
   * æ“ä½œç¬?   */
  operator: QueryOperator | string;
  /**
   * å€?   */
  value?: DatabaseValueType | string[] | number[];
  /**
   * å€?ï¼ˆç”¨äºBETWEENç­‰æ“ä½œç¬¦ï¼?   */
  value2?: DatabaseValueType;
  /**
   * æ˜¯å¦å¿½ç•¥å¤§å°å†?   */
  ignoreCase?: boolean;
}

/**
 * æ’åºæ–¹å¼æšä¸¾
 */
export enum SortOrder {
  /**
   * å‡åº
   */
  ASC = 'ASC',
  /**
   * é™åº
   */
  DESC = 'DESC'
}

/**
 * æ’åºå®šä¹‰æ¥å£
 */
export interface SortDefinition {
  /**
   * æ’åºå­—æ®µ
   */
  field: string;
  /**
   * æ’åºæ–¹å¼
   */
  order: SortOrder;
}

/**
 * åˆ†é¡µå‚æ•°æ¥å£
 */
export interface PaginationParams {
  /**
   * é¡µç ï¼ˆä»1å¼€å§‹ï¼‰
   */
  page: number;
  /**
   * æ¯é¡µå¤§å°
   */
  pageSize: number;
}

/**
 * åˆ†é¡µç»“æœæ¥å£
 */
export interface PaginationResult<T> {
  /**
   * æ•°æ®åˆ—è¡¨
   */
  list: T[];
  /**
   * æ€»æ¡æ•?   */
  total: number;
  /**
   * é¡µç 
   */
  page: number;
  /**
   * æ¯é¡µå¤§å°
   */
  pageSize: number;
  /**
   * æ€»é¡µæ•?   */
  totalPages: number;
}

/**
 * æ‰¹é‡æ“ä½œç»“æœæ¥å£
 */
export interface BatchOperationResult {
  /**
   * æˆåŠŸæ•°é‡
   */
  successCount: number;
  /**
   * å¤±è´¥æ•°é‡
   */
  failedCount: number;
  /**
   * å¤±è´¥é¡¹ç´¢å¼?   */
  failedIndexes: number[];
  /**
   * å¤±è´¥åŸå› 
   */
  failedReasons?: string[];
}

/**
 * æ•°æ®åº“è¿ç§»å®šä¹‰æ¥å? */
export interface Migration {
  /**
   * æºç‰ˆæœ?   */
  fromVersion: number;
  /**
   * ç›®æ ‡ç‰ˆæœ¬
   */
  toVersion: number;
  /**
   * è¿ç§»æ“ä½œ
   */
  migrate: () => Promise<void>;
}

/**
 * æ•°æ®åº“äº‹åŠ¡ç±»å‹æšä¸? */
export enum TransactionType {
  /**
   * åªè¯»äº‹åŠ¡
   */
  READ_ONLY = 'READ_ONLY',
  /**
   * è¯»å†™äº‹åŠ¡
   */
  READ_WRITE = 'READ_WRITE'
}

/**
 * æ•°æ®åº“äº‹åŠ¡æ¥å? */
export interface Transaction {
  /**
   * æ‰§è¡ŒSQLè¯­å¥
   * @param sql SQLè¯­å¥
   * @param params å‚æ•°
   * @returns æ‰§è¡Œç»“æœ
   */
  executeSql(sql: string, params?: (DatabaseValueType)[]): Promise<Object>;
  /**
   * æäº¤äº‹åŠ¡
   */
  commit(): Promise<void>;
  /**
   * å›æ»šäº‹åŠ¡
   */
  rollback(): Promise<void>;
}

/**
 * æ•°æ®æ¨¡å‹æ¥å£ï¼ˆæ‰€æœ‰å®ä½“æ¨¡å‹çš„åŸºç±»ï¼? */
export interface BaseModel {
  /**
   * å”¯ä¸€æ ‡è¯†
   */
  id?: number;
  /**
   * åˆ›å»ºæ—¶é—´
   */
  createdAt?: number;
  /**
   * æ›´æ–°æ—¶é—´
   */
  updatedAt?: number;
}

/**
 * ç”¨æˆ·æ¨¡å‹æ¥å£
 */
export interface UserModel extends BaseModel {
  /**
   * ç”¨æˆ·å?   */
  username: string;
  /**
   * é‚®ç®±
   */
  email?: string;
  /**
   * å¤´åƒ
   */
  avatar?: string;
  /**
   * æœ€åç™»å½•æ—¶é—?   */
  lastLoginAt?: number;
  /**
   * ç”¨æˆ·çŠ¶æ€?   */
  status?: UserStatus;
}

/**
 * ç”¨æˆ·çŠ¶æ€æšä¸? */
export enum UserStatus {
  /**
   * æ´»è·ƒ
   */
  ACTIVE = 'ACTIVE',
  /**
   * ç¦ç”¨
   */
  DISABLED = 'DISABLED',
  /**
   * å¾…éªŒè¯?   */
  PENDING = 'PENDING'
}

/**
 * å†å²è®°å½•æ¨¡å‹æ¥å£
 */
export interface HistoryModel extends BaseModel {
  /**
   * åª’ä½“ID
   */
  mediaId: string;
  /**
   * æ ‡é¢˜
   */
  title: string;
  /**
   * æµ·æŠ¥
   */
  poster?: string;
  /**
   * è¿›åº¦
   */
  progress: number;
  /**
   * æ€»æ—¶é•?   */
  duration: number;
  /**
   * åª’ä½“ç±»å‹
   */
  mediaType: MediaType;
  /**
   * å‰§é›†ä¿¡æ¯
   */
  episode?: string;
  /**
   * ç”¨æˆ·ID
   */
  userId?: number;
}

/**
 * åª’ä½“ç±»å‹æšä¸¾
 */
export enum MediaType {
  /**
   * ç”µå½±
   */
  MOVIE = 'MOVIE',
  /**
   * ç”µè§†å‰?   */
  TV_SERIES = 'TV_SERIES',
  /**
   * ç»¼è‰º
   */
  VARIETY = 'VARIETY',
  /**
   * åŠ¨æ¼«
   */
  ANIME = 'ANIME',
  /**
   * çºªå½•ç‰?   */
  DOCUMENTARY = 'DOCUMENTARY',
  /**
   * ç›´æ’­
   */
  LIVE = 'LIVE',
  /**
   * å…¶ä»–
   */
  OTHER = 'OTHER'
}

/**
 * æ”¶è—æ¨¡å‹æ¥å£
 */
export interface CollectionModel extends BaseModel {
  /**
   * åª’ä½“ID
   */
  mediaId: string;
  /**
   * æ ‡é¢˜
   */
  title: string;
  /**
   * æµ·æŠ¥
   */
  poster?: string;
  /**
   * åˆ†ç±»
   */
  category?: string;
  /**
   * è¯„åˆ†
   */
  rating?: number;
  /**
   * åª’ä½“ç±»å‹
   */
  mediaType: MediaType;
  /**
   * å¤‡æ³¨
   */
  note?: string;
  /**
   * ç”¨æˆ·ID
   */
  userId?: number;
}

/**
 * ä¸‹è½½ä»»åŠ¡æ¨¡å‹æ¥å£
 */
export interface DownloadTaskModel extends BaseModel {
  /**
   * ä»»åŠ¡ID
   */
  taskId: string;
  /**
   * æ ‡é¢˜
   */
  title: string;
  /**
   * ä¸‹è½½URL
   */
  url: string;
  /**
   * ä¿å­˜è·¯å¾„
   */
  savePath: string;
  /**
   * æ€»å¤§å°?   */
  totalSize: number;
  /**
   * å·²ä¸‹è½½å¤§å°?   */
  downloadedSize: number;
  /**
   * çŠ¶æ€?   */
  status: DownloadStatus;
  /**
   * é”™è¯¯ä¿¡æ¯
   */
  errorMessage?: string;
  /**
   * åª’ä½“ç±»å‹
   */
  mediaType?: MediaType;
  /**
   * ä¼˜å…ˆçº?   */
  priority: number;
}

/**
 * ä¸‹è½½çŠ¶æ€æšä¸? */
export enum DownloadStatus {
  /**
   * ç­‰å¾…ä¸?   */
  WAITING = 'WAITING',
  /**
   * ä¸‹è½½ä¸?   */
  DOWNLOADING = 'DOWNLOADING',
  /**
   * æš‚åœ
   */
  PAUSED = 'PAUSED',
  /**
   * å®Œæˆ
   */
  COMPLETED = 'COMPLETED',
  /**
   * å¤±è´¥
   */
  FAILED = 'FAILED',
  /**
   * å–æ¶ˆ
   */
  CANCELLED = 'CANCELLED'
}

/**
 * ç›´æ’­é¢‘é“æ¨¡å‹æ¥å£
 */
export interface LiveChannelModel extends BaseModel {
  /**
   * é¢‘é“ID
   */
  channelId: string;
  /**
   * é¢‘é“åç§°
   */
  name: string;
  /**
   * é¢‘é“Logo
   */
  logo?: string;
  /**
   * æ’­æ”¾URL
   */
  url: string;
  /**
   * åˆ†ç±»
   */
  category: string;
  /**
   * æ˜¯å¦æ”¶è—
   */
  isFavorite: boolean;
  /**
   * æ’åº
   */
  sortOrder: number;
  /**
   * å›½å®¶/åœ°åŒº
   */
  country?: string;
  /**
   * è¯­è¨€
   */
  language?: string;
}

/**
 * é…ç½®é¡¹æ¨¡å‹æ¥å? */
export interface ConfigItemModel extends BaseModel {
  /**
   * é…ç½®é”?   */
  key: string;
  /**
   * é…ç½®å€?   */
  value: string;
  /**
   * å€¼ç±»å?   */
  type: string;
  /**
   * åˆ†ç±»
   */
  category: string;
  /**
   * æè¿°
   */
  description?: string;
}
